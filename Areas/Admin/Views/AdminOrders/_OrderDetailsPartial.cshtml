@model ICollection<DOANLTWT3BANDIENTHOAIDIDONG.Models.OrderDetail>
@using System.Globalization;
@{
    // Thiết lập Culture Info cho định dạng tiền tệ Việt Nam
    CultureInfo vietnameseCulture = new CultureInfo("vi-VN");
}

<div class="card shadow-sm mb-4">
    <div class="card-header bg-primary text-white">
        <i class="fas fa-shopping-basket"></i> Danh sách Sản phẩm Đã Đặt
    </div>
    <div class="card-body p-0">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="thead-light">
                    <tr>
                        <th style="width: 5%;">#</th>
                        <th style="width: 40%;">Sản phẩm</th>
                        <th style="width: 15%;" class="text-right">Đơn giá</th>
                        <th style="width: 15%;" class="text-center">Số lượng</th>
                        <th style="width: 25%;" class="text-right">Thành tiền</th>
                    </tr>
                </thead>
                <tbody>
                    @if (Model != null && Model.Any())
                    {
                        int itemIndex = 1;
                        foreach (var detail in Model)
                        {
                            // Tính toán thành tiền (tổng tiền)
                            decimal itemTotalPrice = detail.Quantity * detail.UnitPrice;

                            <tr>
                                <td>@itemIndex</td>
                                <td>
                                    <span class="font-weight-bold">@detail.Product.ProductName</span>
                                    @* Thêm thông tin mô tả sản phẩm nếu có *@
                                </td>
                                <td class="text-right">
                                    @* Định dạng UnitPrice *@
                                    @detail.UnitPrice.ToString("#,##0", vietnameseCulture) ₫
                                </td>
                                <td class="text-center">
                                    @detail.Quantity
                                </td>
                                <td class="text-right font-weight-bold text-danger">
                                    @* Định dạng TotalPrice (hoặc tính toán lại nếu TotalPrice trong DB là Nullable/tính toán sai) *@
                                    @itemTotalPrice.ToString("#,##0", vietnameseCulture) ₫
                                </td>
                            </tr>
                            itemIndex++;
                        }
                    }
                    else
                    {
                        <tr>
                            <td colspan="5" class="text-center text-muted p-4">
                                <i class="fas fa-box-open"></i> Đơn hàng này không có sản phẩm nào.
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>